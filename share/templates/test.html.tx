: cascade base { title => "Funktionstest", nav => "info" }
: override content -> {

<div class="form noautoload" id="test"></div>

: }
: override postjs -> {

<script type="text/javascript">

// First execute stuff when the form is loaded
$('body').on('sr_config',function(){

  sr_request_mpack('GET','/state',undefined,function(values){
    $("#test").each(function(){
      var fields = new Array();
      // var color_options = new Array({
      //   value: undefined,
      //   label: 'Nicht benutzt',
      //   backgroundcolor: '#ffffff'
      // });
      // $.each(sr_colors,function(i,color){
      //   color_options.push({
      //     value: color.id,
      //     label: color.name,
      //     backgroundcolor: color.color
      //   });
      // });
      for (i = 1; i <= sr_config['pwm_count']; i++) {
        var pwm_key = "" + i;
        fields.push({
          id: "pwm_direct_" + i,
          label: "Wert LED #" + i,
          type: "integer",
          template: "slider",
          value: values.pwms[i],
          data: { pwm_id: i },
          min: 0, max: 1000,
          custom_init: function(){
            var pwm = this.data.pwm_id;
            var html_field = this.html_field();
            html_field.change(function(){
              var data = { pwms: {} };
              data.pwms[pwm] = parseInt(html_field.val());
              //sr_screenblock();
              sr_request_mpack('PUT','/state',data,function(){
                //sr_screenunblock();
              });
            });
          }
        });
      }
      var form = new SrForm(this,{
        title: "Funktionstest",
        no_submit: true,
        fields: fields
      });
    });
  });

});

</script>

: }
